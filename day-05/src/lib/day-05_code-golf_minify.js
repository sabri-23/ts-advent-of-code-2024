let[T,I,L,P]=["split","includes","length","push"];for(Z of(i=require("fs").readFileSync(0,"utf8").trim()[T]`\n`,r=[],u=[],i.map(e=>e[I]`|`?r[P](e[T]`|`.map(Number)):e[I]`,`&&u[P](e[T]`,`.map(Number))),a=b=0,u))if(S=new Set(Z),M=new Map(Z.map((e,s)=>[e,s])),r.every(([e,s])=>!S.has(e)||!S.has(s)||M.get(e)<M.get(s)))a+=Z[Z[L]>>1];else{for(V in G={},D={},S.forEach(e=>(G[e]=[],D[e]=0)),Q=[],r.map(([e,s])=>S.has(e)&&S.has(s)&&(G[e][P](s),D[s]++)),D)D[V]||Q[P](V);for(O=[];Q[L];){let e=Q.shift();O[P](+e),G[e].map(e=>{--D[e]||Q[P](e)})}b+=O[O[L]>>1]}console.log(a,b);